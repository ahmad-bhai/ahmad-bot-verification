<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ID Verification</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #0e121a; color: white; font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; }
        .success-card { display: none; background: white; color: black; padding: 30px; border-radius: 20px; text-align: center; width: 85%; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .btn-success { background: #05c55e; color: white; border: none; padding: 12px 20px; border-radius: 10px; font-weight: bold; width: 100%; cursor: pointer; margin-top: 15px; }
        @keyframes heartbeat {0%{color:#ffb3b3} 35%{color: #ff1a1a} 100%{color:#ffb3b3}} 
        dialog::backdrop {background:#05c55e;opacity:.25}
    </style>
</head>
<body>

    <div id="successCard" class="success-card">
        <h2 style="color: #05c55e;">‚úÖ VERIFIED</h2>
        <p>Your ID is registered in our database.</p>
        <button class="btn-success" onclick="sendToBot()">START BOT NOW</button>
    </div>

    <script>
        const webApp = window.Telegram.WebApp;
        webApp.ready();
        webApp.expand();

        const urlParams = new URLSearchParams(window.location.search);
        const userUID = urlParams.get('id');

        // Firebase Configuration
        const dbURL = "https://reactions-maker-site-default-rtdb.firebaseio.com/users.json";

        if (userUID) {
            fetch(dbURL).then(r => r.json()).then(data => {
                let isUnlocked = false;
                if (data) {
                    Object.values(data).forEach(u => { if (u.id === userUID) isUnlocked = true; });
                }

                if (isUnlocked) {
                    document.getElementById('successCard').style.display = 'block';
                } else {
                    showLockDialog(userUID);
                }
            }).catch(() => showLockDialog("Error connecting to DB"));
        }

        function showLockDialog(id) {
            var color = "#1c242a";
            var html = `<div style="font-family: sans-serif;padding:1rem;background:${color};width:${window.innerWidth>500?"400px":(window.innerWidth-60)+"px"};border-top: 5px solid #05c55e" class="dia">
                        <div style="text-align:center"><div style="line-height:50px;font-size:30px;color:#fff; font-weight:900">LOCKED</div>
                        <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="50pt" height="50pt" viewBox="0 0 180.000000 180.000000" style="display:inline-block;text-align:center">
                        <g transform="translate(0.000000,180.000000) scale(0.100000,-0.100000)" fill="#fff">
                        <path d="M753 1622 l-133 -77 0 -67 0 -67 87 50 c49 28 96 55 105 60 17 9 18 -23 18 -626 l0 -636 -50 28 -50 28 0 443 0 442 -55 0 -55 0 0 -405 c0 -223 -3 -405 -7 -405 -5 0 -27 10 -50 22 l-43 23 0 308 0 308 -57 -3 -58 -3 -5 -267 -5 -267 -40 22 -40 23 0 339 0 339 103 59 102 59 0 64 c0 35 -3 64 -6 64 -4 0 -78 -41 -165 -92 l-159 -92 0 -401 0 -401 342 -198 c189 -110 348 -199 353 -199 6 0 164 89 353 199 l342 199 0 400 0 400 -159 93 c-87 50 -161 92 -165 92 -3 0 -6 -29 -6 -64 l0 -63 103 -60 102 -59 0 -339 0 -340 -42 -23 -43 -23 0 270 0 271 -60 0 -60 0 0 -307 0 -308 -40 -22 c-21 -13 -41 -23 -44 -23 -4 0 -6 182 -6 405 l0 405 -60 0 -60 0 0 -443 0 -442 -46 -28 c-26 -15 -48 -26 -50 -24 -2 2 -3 288 -2 635 l3 632 103 -60 c57 -33 105 -60 108 -60 2 0 4 29 4 65 l0 64 -92 54 c-51 30 -113 66 -138 80 l-45 26 -132 -77z"/></g>
                        </svg></div><br><div style="text-align:center;color:#fff;word-break:break-all;font-size:14px;">ID: ${id}</div><br>
                        <div style="text-align: center;"><button id="closeBtn" style="padding:10px 20px;background:#05c55e;color:#fff;border:none;cursor:pointer">CLOSE</button></div><br>
                        <div style="color:#ff6251;font-size:12px;text-align:left">üìù CONTACT +923120883884 TO UNLOCK !!! üîì</div>
                        <hr style="border-color:#fff">
                        <div style="text-align:center;font-weight:100;color:#fff">Made with <span style="color: #ff1a1a; animation: heartbeat 1.4s infinite;">‚ô•</span> by <a style="color:#fff;text-decoration:none;" href="https://t.me/AhmadTrader3">@AhmadTrader3</a></div>
                        </div>`;
            
            var myDialog = document.createElement("dialog");
            myDialog.style.padding = "0";
            myDialog.style.border = "none";
            myDialog.style.background = "transparent";
            document.body.appendChild(myDialog);
            myDialog.innerHTML = html;
            myDialog.showModal();
            myDialog.querySelector("#closeBtn").addEventListener("click", () => {
                webApp.close();
            });
        }

        function sendToBot() {
            window.location.href = "https://t.me/DISITS8_ID_GENERATOR_BOT?start=unlocked";
        }
    </script>
</body>
</html>
